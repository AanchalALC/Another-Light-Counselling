{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-163396537-1"
    ></script>
    <script async>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-163396537-1");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- GOOGLE VERIFICATION -->
    <meta
      name="google-site-verification"
      content="DWUpiMGXX6mLCET2Q0RLmDtoWy0LXMkqFMr40KtVjBA"
    />

    <title>{% block title %}{% endblock %}</title>
    <meta
      name="description"
      content="{% block metadescription %}{% endblock %}"
    />
    <meta name="keywords" content="{% block metakeywords %}{% endblock %}" />

    {% comment %} OPENGRAPH META TAGS {% endcomment %}
    <meta property="og:title" content="{% block ogtitle %}{% endblock %}" />
    <meta
      property="og:description"
      content="{% block ogdescription %}{% endblock %}"
    />
    <meta property="og:url" content="{% block ogurl %}{% endblock %}" />
    <meta property="og:image" content="{% block ogimage %}{% endblock %}" />
    <meta property="og:type" content="{% block ogtype %}{% endblock %}" />

    <!-- TWITTER CARD META TAGS -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:creator" content="@aanchal_therapy" />
    <meta name="twitter:title" content="{% block tctitle %}{% endblock %}" />
    <meta
      name="twitter:description"
      content="{% block tcdescription %}{% endblock %}"
    />
    <meta name="twitter:image" content="{% block tcimage %}{% endblock %}" />

    <!-- FONTAWESOME -->
    <link href="{% static 'css/fontawesome.css' %}" rel="stylesheet" />
    <link href="{% static 'css/all.css' %}" rel="stylesheet" />

    <!-- BOOTSTRAP 4 CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      crossorigin="anonymous"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/tippy.js@6/animations/scale.css"
    />
    <link rel="stylesheet" href="{% static 'css/onboarding_plan.css' %}" />
    <link rel="stylesheet" href="{% static 'css/services.css' %}" />

    <!-- JQUERY -->
    <script
      src="https://code.jquery.com/jquery-3.2.1.min.js"
      crossorigin="anonymous"
    ></script>

    <!-- WAYPOINTS + COUNTUP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
    <script src="{% static 'js/jquery.countup.min.js' %}"></script>

    <!-- FAVICON -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="{% static 'img/favicon.ico' %}"
    />

    {% block head %}{% endblock %}
  </head>

  <body>
    <div id="wrapper">
      <!-- HEADER -->
      <div id="topheader">
        <!-- Logo: always top-left, no padding/margin -->
        <a href="{% url 'index' %}" id="logolink">
          <img
            id="sitelogo"
            src="{% static 'img/skeleton/sitelogo.png' %}"
            alt="Another Light"
          />
        </a>

        <!-- TOP NAVBAR: CONTACT ICONS (white background) -->
        <nav id="topcontactnav" class="navbar navbar-light p-0">
          <div id="contactrow">
            <a href="{{ h_contacts.instagram.url }}" target="_blank">
              <i class="{{h_contacts.instagram.symbol}} site-logo"></i>
            </a>
            <a href="{{h_contacts.whatsapp.url}}" target="_blank">
              <i class="{{h_contacts.whatsapp.symbol}} site-logo"></i>
            </a>
            <a href="{{h_contacts.phone.url}}" target="_blank">
              <i class="{{h_contacts.phone.symbol}} phoneicon site-logo"></i>
            </a>
          </div>
        </nav>

        <!-- MAIN NAVBAR: has coloured background + rainbow -->
        <div id="mainnav-container">
          <div id="colordiv"></div>
          <div id="rainbowdiv"></div>

          <nav
            id="main-navbar"
            class="navbar navbar-expand-lg navbar-light bg-transparent p-0"
          >
            <!-- Hamburger / Close button (Bootstrap collapse) -->
            <button
              class="navbar-toggler ml-auto"
              type="button"
              data-toggle="collapse"
              data-target="#mainNavbarContent"
              aria-controls="mainNavbarContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <i class="fas fa-bars"></i>
            </button>

            <!-- Collapsible content (desktop + mobile drawer) -->
            <div
              class="collapse navbar-collapse justify-content-end"
              id="mainNavbarContent"
            >
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'index' %}">Home</a>
                </li>

                <li class="nav-item">
                  <a class="nav-link" href="{% url 'about' %}">Meet Our Team</a>
                </li>

                <!-- Services dropdown -->
                <li class="nav-item" id="servicedropdown">
                  <a
                    class="nav-link"
                    id="servicebutton"
                    href="javascript:void(0);"
                  >
                    Services
                  </a>
                  <div id="dropdowncontent">
                    {% for service in services %}
                    <a href="{% url 'service' service.slug %}">
                      {{ service.title }}
                    </a>
                    {% endfor %}
                  </div>
                </li>

                <!-- Signature Plans dropdown -->
                <li class="nav-item" id="plandropdown">
                  <a
                    class="nav-link"
                    id="planbutton"
                    href="javascript:void(0);"
                  >
                    Signature Plans
                  </a>
                  <div id="dropdowncontentplan">
                    <a href="{% url 'onboarding_plan' %}">
                      Structured Support from Aanchal
                    </a>
                  </div>
                </li>

                <!-- Do I Feel dropdown -->
                <li class="nav-item" id="doifeeldropdown">
                  <a
                    class="nav-link"
                    id="doifeelbutton"
                    href="javascript:void(0);"
                  >
                    Do I Feel?
                  </a>
                  <div id="dropdowncontentdoifeel">
                    {% for doifeel in doifeels %}
                    <a href="{% url 'doifeel' doifeel.slug %}">
                      {{ doifeel.title }}
                    </a>
                    {% endfor %}
                  </div>
                </li>

                <li class="nav-item">
                  <a class="nav-link" href="{% url 'faqs' %}">FAQs</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'resources' %}">
                    Resources
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'reviews' %}">Reviews</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'blog' %}">Blog</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'contact' %}">Contact</a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </div>

      <!-- Optional overlay (still available if you want to re-use) -->
      <div id="navOverlay" class="nav-overlay"></div>

      {% block body %}{% endblock %}

      <!-- FOOTER -->
      <div id="footer">
        <div id="footercontacts" class="footersection">
          <h4>Contact Details</h4>
          {% for contactdetail in contactdetails %}
          <a href="{{contactdetail.url}}" target="_blank">
            <strong><i class="{{contactdetail.symbol}}"></i></strong>
            {{contactdetail.value}}
          </a>
          {% endfor %}
        </div>

        <div id="footerlinks" class="footersection">
          <h4>Quick Links</h4>
          <a href="{% url 'index' %}">Home</a>
          <a href="{% url 'about' %}">Meet Our Team</a>
          <a href="{% url 'faqs' %}">FAQs</a>
          <a href="{% url 'resources' %}">Resources</a>
          <a href="{% url 'reviews' %}">Reviews</a>
          <a href="{% url 'blog' %}">Blog</a>
          <a href="{% url 'contact' %}">Contact</a>
          <a href="{% url 'policy' 'posh' %}">PoSH Policy</a>
          <a href="{% url 'policy' 'cancel-refund' %}">
            Cancellation & Refund Policy
          </a>
          <a href="{% url 'policy' 'privacy-confidentiality' %}">
            Privacy & Confidentiality Policy
          </a>
          <a href="{% url 'careers' %}">Careers</a>
        </div>

        <div id="footerservices" class="footersection">
          <h4></h4>
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d15077.75827412004!2d72.8305922!3d19.1322267!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x7dc155bf53680e9b!2sAnother%20Light%20Counselling!5e0!3m2!1sen!2sin!4v1662820553961!5m2!1sen!2sin"
            width="400"
            height="300"
            style="border: 0"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          ></iframe>
        </div>

        <div id="bottomlinks"></div>
      </div>
    </div>

    <!-- TOOLTIPS -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <script src="{% static 'js/tooltips.js' %}"></script>

    <!-- ACCESSIBILITY -->
    <script async>
      (function (d) {
        var s = d.createElement("script");
        s.setAttribute("data-account", "dcGEfQ47Vq");
        s.setAttribute("src", "https://cdn.userway.org/widget.js");
        (d.body || d.head).appendChild(s);
      })(document);
    </script>
    <noscript>
      Please ensure Javascript is enabled for purposes of
      <a href="https://userway.org">website accessibility</a>
    </noscript>

    <!-- BOOTSTRAP 4 JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      crossorigin="anonymous"
    ></script>

    <!-- count up -->
    <script src="{% static 'js/countnumbers.js' %}"></script>

    <!-- SERVICE DROPDOWN FUNCTIONALITY (existing) -->
    <script src="{% static 'js/servicemenu.js' %}"></script>

    <!-- NAV: X toggle + hard navigation on mobile + mobile dropdown toggles -->
    <script>
      $(function () {
        var $nav = $("#mainNavbarContent");
        var $toggler = $(".navbar-toggler");

        // Swap hamburger â†” X based on collapse state
        $nav.on("show.bs.collapse", function () {
          $toggler.addClass("is-open");
          $toggler.find("i").removeClass("fa-bars").addClass("fa-times");
        });

        $nav.on("hide.bs.collapse", function () {
          $toggler.removeClass("is-open");
          $toggler.find("i").removeClass("fa-times").addClass("fa-bars");
        });

        // Force navigation on mobile even if some script calls preventDefault
        document.addEventListener(
          "click",
          function (e) {
            var link = e.target.closest("#mainNavbarContent .nav-link");
            if (!link) return;

            var href = link.getAttribute("href");
            // ignore dropdown toggles and fake links
            if (!href || href === "#" || href.indexOf("javascript:") === 0) {
              return;
            }

            if (window.innerWidth <= 1400) {
              e.preventDefault();
              window.location.href = href;
            }
          },
          true
        );

        // Mobile dropdown toggles for Services / Plans / Do I Feel?
        function toggleMobileDropdown(buttonSelector, contentSelector) {
          $(buttonSelector).on("click", function (e) {
            if (window.innerWidth > 1400) {
              return; // desktop handled by hover CSS
            }
            e.preventDefault();
            var $content = $(contentSelector);
            $content.slideToggle(180);
          });
        }

        toggleMobileDropdown("#servicebutton", "#dropdowncontent");
        toggleMobileDropdown("#planbutton", "#dropdowncontentplan");
        toggleMobileDropdown("#doifeelbutton", "#dropdowncontentdoifeel");
      });
    </script>
  </body>
</html>
